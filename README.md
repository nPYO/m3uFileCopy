# m3uFileCopy

m3uFileCopy は、iTunes のライブラリ XML（`iTunes Library.xml`）を読み込み、
選択したプレイリストの楽曲ファイルを USB メモリなどへ一括コピーし、
同時に `.m3u` プレイリストを出力する Windows 向けツールです。

## 動作環境

- Windows 10 64bit（確認環境）
- .NET Framework 4.7.2
- iTunes 12.11.4.15（確認環境）

## 事前準備（iTunes 側）

本ツールの利用前に、iTunes で以下を設定してください。

1. `編集` → `環境設定`
2. `詳細` タブを開く
3. **「iTunesライブラリXMLをほかのアプリケーションと共有」** を ON

この設定が OFF だと `iTunes Library.xml` が生成されず、読み込みできません。

## 基本的な使い方

1. `m3uFileCopy.exe` を起動
2. ライブラリファイルを読み込み（初回や未検出時はファイル選択ダイアログが表示）
3. プレイリスト一覧から対象を選択
4. `ファイル` → `プレイリストファイル出力` を実行
5. 出力先フォルダとオプションを指定してコピー開始

## 主な機能

- iTunes プレイリスト一覧の表示
- プレイリスト内トラック一覧の表示
- 選択プレイリストの曲数 / 合計時間 / 合計サイズ表示
- トラックのダブルクリック再生（Windows Media Player コントロール）
- プレイリスト単位のファイルコピー
- `.m3u` ファイル自動生成（UTF-8）

## コピー時オプション

### ファイル名モード

- 元ファイル名をそのまま使用
- `0001_元ファイル名` 形式
- `0001.mp3` のような連番 + 拡張子形式

### 追加オプション

- 再生時間を無効化（`#EXTINF:-1` で出力）
- iTunes 付与の先頭トラック番号除去（例: `01 曲名.mp3` → `曲名.mp3`）

## 出力イメージ

```text
出力先フォルダ\プレイリスト名\(コピーされた楽曲ファイル)
出力先フォルダ\プレイリスト名.m3u
```

`.m3u` には次のような形式で書き込まれます。

```text
#EXTM3U
#EXTINF:-1,曲名 - アーティスト名
プレイリスト名\0001_ファイル名.mp3
```

## 注意事項

- ローカルに未ダウンロードの楽曲（Location なし）はコピーできません。
- 出力先に同名フォルダがある場合、確認後に削除して再作成します。
- 大量コピー前に空き容量とバックアップを確認してください。

## 設定ファイル

以下の情報は設定ファイルに保存され、次回起動時に復元されます。

- iTunes ライブラリ XML のパス
- 出力先フォルダ
- ファイル名モード
- 各オプションの ON/OFF

保存先（既定）:

`C:\Users\<User>\AppData\Local\nPYO\m3uFileCopy.ini`
